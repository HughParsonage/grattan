<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Australian Tax Policy Analysis • grattan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Australian Tax Policy Analysis">
<meta property="og:description" content="Utilities for costing and evaluating Australian tax policy, including high-performance tax and transfer calculators, a fast method of projecting tax collections, and an interface to common indices from the Australian Bureau of Statistics.  Written to support Grattan Institute's Australian Perspectives program. For access to the 'taxstats' package, please run
 install.packages(&quot;taxstats&quot;, repos = &quot;https://hughparsonage.github.io/tax-drat/&quot;, type = &quot;source&quot;). 
 N.B. The 'taxstats' package is approximately 50 MB.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">grattan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/grattan.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/datatable-implementation.html">Calculations of income tax are rolling joins</a>
    </li>
    <li>
      <a href="articles/long-vignettes/budget-2018.html">Budget 2018 modelling</a>
    </li>
    <li>
      <a href="articles/long-vignettes/issues/166.html">2015-16 size of dividends credit</a>
    </li>
    <li>
      <a href="articles/long-vignettes/population/forecasting-population.html">Forecasting population</a>
    </li>
    <li>
      <a href="articles/model-income-tax.html">Model income tax and project</a>
    </li>
    <li>
      <a href="articles/v201515-taxstats.html">2015-16 taxstats miscellany</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HughParsonage/grattan">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<div id="grattan" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#grattan" class="anchor"></a>grattan</h1></div>
<p>Utilities for costing and evaluating Australian tax policy, including high-performance tax and transfer calculators, a fast method of projecting tax collections from ATO sample files, and an interface to common indices from the Australian Bureau of Statistics. Written to support Grattan Institute’s Australian Perspectives program.</p>
<blockquote>
<p>Important temporary notice (2019-02-09): The vignettes do not run on pandoc v2.4 (or take a very long time). Please upgrade to v2.6 (2019-01-30) if building vignettes. You may need to modify the PATH or change the RSTUDIO_PANDOC env. var after installing.</p>
</blockquote>
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"grattan"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(grattan)</a></code></pre></div>
<div id="income_tax" class="section level2">
<h2 class="hasAnchor">
<a href="#income_tax" class="anchor"></a><code>income_tax</code>
</h2>
<p>Calculates the income tax for a given taxable income and financial year:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="reference/income_tax.html">income_tax</a></span>(<span class="fl">50e3</span>, <span class="st">"2015-16"</span>)</a></code></pre></div>
<pre><code>## [1] 8547</code></pre>
<div id="with-sample-files" class="section level3">
<h3 class="hasAnchor">
<a href="#with-sample-files" class="anchor"></a>With sample files</h3>
<p><code>income_tax</code> is designed to work well with the ATO’s sample files. You can obtain the sample files from my repo:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># install.packages("taxstats", repos = "https://hughparsonage.github.io/tax-drat")</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(taxstats)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hutils)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table) </a>
<a class="sourceLine" id="cb5-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a></code></pre></div>
<pre><code>## Registered S3 methods overwritten by 'ggplot2':
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang</code></pre>
<p>Simply pass the sample file to <code>.dots.ATO</code> and the complexities of things like Medicare levy and the Seniors and Pensioners Tax Offset are handled for you. For example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">s1314 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/as.data.table">as.data.table</a></span>(sample_file_<span class="dv">1314</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">s1314 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span>.[, tax <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="reference/income_tax.html">income_tax</a></span>(Taxable_Income, <span class="st">"2013-14"</span>, <span class="dt">.dots.ATO =</span> s1314)] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span>.[, .(Taxable_Income, tax)]</a></code></pre></div>
<pre><code>##         Taxable_Income       tax
##      1:           4800     0.000
##      2:         126122 36503.970
##      3:          39742  4655.410
##      4:         108123 29574.355
##      5:          85957 21040.445
##     ---                         
## 258770:          24462  1111.710
## 258771:          37055  3701.525
## 258772:          45024  6530.520
## 258773:           5134     0.000
## 258774:          46368  7007.640</code></pre>
</div>
</div>
<div id="model_income_tax-modelling-changes-to-personal-income-tax" class="section level2">
<h2 class="hasAnchor">
<a href="#model_income_tax-modelling-changes-to-personal-income-tax" class="anchor"></a><code>model_income_tax</code>: modelling changes to personal income tax</h2>
<p>While <code>income_tax</code> is designed to inflexibly return the tax payable as legislated, <code>model_income_tax</code> is designed to calculate income tax when changes are made. For example,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">s1314 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="co"># reduce top threshold from 180,000 to 150,000</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw"><a href="reference/model_income_tax.html">model_income_tax</a></span>(<span class="dt">ordinary_tax_thresholds =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">18200</span>, <span class="dv">37000</span>, <span class="dv">80000</span>, </a>
<a class="sourceLine" id="cb9-4" title="4">                                               <span class="fl">150e3</span>), </a>
<a class="sourceLine" id="cb9-5" title="5">                   <span class="dt">baseline_fy =</span> <span class="st">"2013-14"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span>.[, .(Taxable_Income, baseline_tax, new_tax)]</a></code></pre></div>
<pre><code>##         Taxable_Income baseline_tax   new_tax
##      1:           4800            0     0.000
##      2:         126122        36503 36503.970
##      3:          39742         4655  4655.410
##      4:         108123        29574 29574.355
##      5:          85957        21040 21040.445
##     ---                                      
## 258770:          24462         1111  1111.710
## 258771:          37055         3701  3701.525
## 258772:          45024         6530  6530.520
## 258773:           5134            0     0.000
## 258774:          46368         7007  7007.640</code></pre>
</div>
<div id="project" class="section level2">
<h2 class="hasAnchor">
<a href="#project" class="anchor"></a><code>project</code>
</h2>
<p>Given a sample file, we can project forward a number of years</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">s1617 &lt;-<span class="st"> </span><span class="kw"><a href="reference/project.html">project</a></span>(s1314, <span class="dt">h =</span> 3L)</a></code></pre></div>
<p>or to a particular financial year</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">s1718 &lt;-<span class="st"> </span><span class="kw"><a href="reference/project_to.html">project_to</a></span>(s1314, <span class="st">"2017-18"</span>)</a></code></pre></div>
<p>Together with <code>model_income_tax</code>, this allows us to make point-predictions of future years. The function <code>revenue_foregone</code> prettily prints the resultant revenue:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">sample_file_<span class="dv">1314</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw"><a href="reference/project_to.html">project_to</a></span>(<span class="st">"2018-19"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw"><a href="reference/model_income_tax.html">model_income_tax</a></span>(<span class="dt">baseline_fy =</span> <span class="st">"2017-18"</span>,</a>
<a class="sourceLine" id="cb13-4" title="4">                   <span class="dt">ordinary_tax_thresholds =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">18200</span>, <span class="dv">37000</span>, <span class="dv">87000</span>, </a>
<a class="sourceLine" id="cb13-5" title="5">                                               <span class="fl">150e3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span>revenue_foregone</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'xts':
##   method     from
##   as.zoo.xts zoo</code></pre>
<pre><code>## Registered S3 method overwritten by 'quantmod':
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## Registered S3 methods overwritten by 'forecast':
##   method             from    
##   fitted.fracdiff    fracdiff
##   residuals.fracdiff fracdiff</code></pre>
<pre><code>## [1] "$1.7 billion"</code></pre>
<div id="compare_avg_tax_rates" class="section level3">
<h3 class="hasAnchor">
<a href="#compare_avg_tax_rates" class="anchor"></a><code>compare_avg_tax_rates</code>:</h3>
<p>Create comparison of average tax rates:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"30k"</span> =<span class="st"> </span><span class="fl">30e3</span>,</a>
<a class="sourceLine" id="cb18-2" title="2">            <span class="st">"36k"</span> =<span class="st"> </span><span class="fl">36e3</span>,</a>
<a class="sourceLine" id="cb18-3" title="3">            <span class="st">"42k"</span> =<span class="st"> </span><span class="fl">42e3</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">       <span class="cf">function</span>(T2) {</a>
<a class="sourceLine" id="cb18-5" title="5">         <span class="kw"><a href="reference/model_income_tax.html">model_income_tax</a></span>(s1718,</a>
<a class="sourceLine" id="cb18-6" title="6">                          <span class="dt">baseline_fy =</span> <span class="st">"2017-18"</span>,</a>
<a class="sourceLine" id="cb18-7" title="7">                          <span class="dt">ordinary_tax_thresholds =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb18-8" title="8">                                                      <span class="dv">18200</span>,</a>
<a class="sourceLine" id="cb18-9" title="9">                                                      T2,</a>
<a class="sourceLine" id="cb18-10" title="10">                                                      <span class="dv">87000</span>, </a>
<a class="sourceLine" id="cb18-11" title="11">                                                      <span class="fl">180e3</span>))</a>
<a class="sourceLine" id="cb18-12" title="12">       }) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/rbindlist">rbindlist</a></span>(<span class="dt">idcol =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb18-14" title="14">            <span class="dt">use.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb18-15" title="15">            <span class="dt">fill =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">  </span><span class="kw"><a href="reference/compare_avg_tax_rates.html">compare_avg_tax_rates</a></span>(<span class="dt">baseDT =</span> .[id <span class="op">%ein%</span><span class="st"> "36k"</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> Taxable_Income_percentile,</a>
<a class="sourceLine" id="cb18-18" title="18">             <span class="dt">y =</span> delta_avgTaxRate,</a>
<a class="sourceLine" id="cb18-19" title="19">             <span class="dt">color =</span> id,</a>
<a class="sourceLine" id="cb18-20" title="20">             <span class="dt">group =</span> id)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>()</a></code></pre></div>
<p><img src="../../../../Dropbox%20(Grattan%20Institute)/Matt%20Cowgill/hughparsonage/grattan/man/figures/README_compare-30-37-42-thresholds-1.png" width="700"></p>
</div>
</div>
</div>
<div id="news" class="section level1">
<h1 class="hasAnchor">
<a href="#news" class="anchor"></a>NEWS</h1>
<div id="section" class="section level2">
<h2 class="hasAnchor">
<a href="#section" class="anchor"></a>1.7.1.1</h2>
<ul>
<li>
<code>grattan</code> now depends on R 3.5.0 due to serialization format version 3 becoming the default in R 3.6.0.</li>
<li>
<code>cpi_inflator</code> fails more gracefully when the ABS’s website is not available</li>
</ul>
</div>
<div id="section-1" class="section level2">
<h2 class="hasAnchor">
<a href="#section-1" class="anchor"></a>1.7.1.0</h2>
<div id="bug-fixes" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>Bug fixes</h3>
<ul>
<li>
<code>income_tax</code> now gives consistent results modulo the existence of completely empty columns that are inputs for <code>sapto</code> (#158)</li>
<li>
<code>income_tax</code> will work if <code>.dots.ATO</code> is a non-data.table data.frame.</li>
<li>
<code>model_income_tax</code>:
<ul>
<li>Correctly imputes SAPTO vs non-SAPTO family thresholds when both provided.</li>
<li>
<code>sapto_rcpp</code> is now more careful about passing length-one vectors to vectorized C++ functions.</li>
</ul>
</li>
<li>
<code>project</code> now correctly prioritizes <code>excl_vars</code> over variables with otherwise predefined uprating mechanisms (such as <code>Sw_amt</code>).</li>
</ul>
</div>
<div id="new-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#new-functions" class="anchor"></a>New functions:</h3>
<ul>
<li>
<code>awote</code> for weekly earnings</li>
</ul>
</div>
<div id="enhancements" class="section level3">
<h3 class="hasAnchor">
<a href="#enhancements" class="anchor"></a>Enhancements:</h3>
<ul>
<li>
<code>age_grouper</code> can now have a custom first label prefix, and is much faster when <code><a href="https://www.rdocumentation.org/packages/base/topics/length">length(age)</a></code> is large.</li>
<li>
<code>income_tax</code> now emits a warning when both age and <code>.dots.ATO</code> are provided, indicating that <code>age</code> will be ignored.</li>
<li>The data has been updated to 2019-02-23.</li>
</ul>
</div>
<div id="internal" class="section level3">
<h3 class="hasAnchor">
<a href="#internal" class="anchor"></a>Internal</h3>
<ul>
<li>
<code>mutate_ntile</code> and <code>weighted_ntile</code> now use the <code>hutils</code> equivalents. This broke 3 unit tests because of the specific phrasing of some error messages.</li>
<li>The vignette requires pandoc &gt; 2.4. Some chunks have been refactored to avoid excess memory usage.</li>
</ul>
</div>
</div>
<div id="section-2" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2" class="anchor"></a>1.7.0.0</h2>
<div id="bug-fixes-1" class="section level3">
<h3 class="hasAnchor">
<a href="#bug-fixes-1" class="anchor"></a>Bug fixes</h3>
<ul>
<li>Fixed failing interaction between temporary budget repair levy and small business tax offset in 2016-17.</li>
<li>
<code><a href="reference/small_business_tax_offset.html">small_business_tax_offset()</a></code> is now always positive, fixing the original misinterpretation of the legislation whereby negative business income resulted in a negative offset.</li>
<li>
<code>*_inflator</code> functions now return correct results for non-standard but supported financial years.</li>
<li>
<code>inflator</code> no longer fails when <code>to_fy</code> is length &gt; 1 and unordered.</li>
</ul>
</div>
<div id="new-features" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New features</h3>
<ul>
<li>
<code>mutate_ntile</code> and <code>mutate_weighted_ntile</code> for adding quantile columns</li>
<li>New welfare functions (usable for the 2015-16 financial year)
<ul>
<li>
<code>age_pension</code>,</li>
<li><code>carer_payment</code></li>
<li><code>carers_allowance</code></li>
<li><code>energy_supplement</code></li>
<li><code>family_tax_benefit</code></li>
<li><code>newstart_allowance</code></li>
<li><code>pension_supplement</code></li>
<li>
<code>rent_assistance</code> the Commonwealth Rent Assistance</li>
<li>
<code>model_rent_assistance</code> as experimental function for modelling changes to rent assistance.</li>
<li>
<code><a href="reference/youth_allowance.html">youth_allowance()</a></code> now available, though limited</li>
</ul>
</li>
<li>
<code>compare_avg_tax_rates</code>: create a difference in average tax rates between multiple models and a baseline tax, by percentile.</li>
<li>
<code><a href="reference/install_taxstats.html">install_taxstats()</a></code> as a convenient means to install the non-CRAN <code>taxstats</code> dependency.</li>
</ul>
</div>
<div id="enhancements-1" class="section level3">
<h3 class="hasAnchor">
<a href="#enhancements-1" class="anchor"></a>Enhancements</h3>
<ul>
<li>
<code>prohibit_vector_recycling()</code> and friends return more informative error messages.</li>
<li>Added default values to the following functions:
<ul>
<li>
<code>income_tax</code>, <code>income_tax_sapto</code>: the default value for fy.year is the current financial year</li>
<li>
<code>cpi_inflator</code>, <code>lf_inflator_fy</code>, <code>wage_inflator</code>: if both from_fy and to_fy are missing, the default values become the previous and current financial years respectively. If only one of the two are missing, an error appears.</li>
</ul>
</li>
<li>
<code>income_tax</code> is about twice as fast since 1.6.0.0: 1.5-2.0s down from 3.0-3.7s on the 100% population (13 million)</li>
<li>
<code>inflator</code> and <code>cpi_inflator</code>, <code>lf_inflator_fy</code>, and <code>wage_inflator</code> are now much faster when either <code>from_fy</code> or <code>to_fy</code> have more than 100,000 elements:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">19952010</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">from_fys &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="reference/is.fy.html">yr2fy</a></span>(<span class="dv">1995</span><span class="op">:</span><span class="dv">2010</span>), <span class="dt">size =</span> <span class="fl">1e6</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">microbenchmark</span>(<span class="kw"><a href="reference/cpi_inflator.html">cpi_inflator</a></span>(<span class="dt">from_fy =</span> from_fys, <span class="dt">to_fy =</span> <span class="st">"2015-16"</span>))</a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co"># Old</span></a>
<a class="sourceLine" id="cb19-5" title="5">Unit<span class="op">:</span><span class="st"> </span>seconds</a>
<a class="sourceLine" id="cb19-6" title="6">                                                expr      min      lq     mean   median       uq</a>
<a class="sourceLine" id="cb19-7" title="7"> <span class="kw"><a href="reference/cpi_inflator.html">cpi_inflator</a></span>(<span class="dt">from_fy =</span> from_fys, <span class="dt">to_fy =</span> <span class="st">"2015-16"</span>) <span class="fl">1.519483</span> <span class="fl">1.54438</span> <span class="fl">1.550628</span> <span class="fl">1.549735</span> <span class="fl">1.554507</span></a>
<a class="sourceLine" id="cb19-8" title="8">      max neval</a>
<a class="sourceLine" id="cb19-9" title="9"> <span class="fl">1.661502</span>   <span class="dv">100</span></a>
<a class="sourceLine" id="cb19-10" title="10"> </a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co"># New</span></a>
<a class="sourceLine" id="cb19-12" title="12">Unit<span class="op">:</span><span class="st"> </span>milliseconds</a>
<a class="sourceLine" id="cb19-13" title="13">                                                expr      min       lq     mean   median       uq</a>
<a class="sourceLine" id="cb19-14" title="14"> <span class="kw"><a href="reference/cpi_inflator.html">cpi_inflator</a></span>(<span class="dt">from_fy =</span> from_fys, <span class="dt">to_fy =</span> <span class="st">"2015-16"</span>) <span class="fl">40.71753</span> <span class="fl">41.94061</span> <span class="fl">47.93162</span> <span class="fl">42.93946</span> <span class="fl">48.08461</span></a>
<a class="sourceLine" id="cb19-15" title="15">      max neval</a>
<a class="sourceLine" id="cb19-16" title="16"> <span class="fl">191.3497</span>   <span class="dv">100</span></a></code></pre></div>
</div>
<div id="potentially-breaking-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#potentially-breaking-changes" class="anchor"></a>Potentially breaking changes</h3>
<ul>
<li>
<code><a href="reference/is.fy.html">yr2fy(x)</a></code> no longer works for x = 1900L, despite a unit test, for the sake of performance.</li>
</ul>
<pre><code>  #&gt; Last change: NAMESPACE at 2018-08-19 14:47:14 (4 mins ago).
  #&gt; Unit: milliseconds
  #&gt;       expr min  lq mean median  uq max neval cld
  #&gt;   yr2fy(z)  75  88   98     90 101 161   100  a 
  #&gt;  .yr2fy(z) 274 286  298    297 302 359   100   b</code></pre>
<p>Use <code><a href="reference/is.fy.html">yr2fy(x, assume1901_2100 = FALSE)</a></code> if you need the old behaviour.</p>
</div>
<div id="miscinternal" class="section level3">
<h3 class="hasAnchor">
<a href="#miscinternal" class="anchor"></a>Misc/Internal</h3>
<ul>
<li>
<code>taxstats1516</code> is now a suggested dependency.</li>
</ul>
</div>
</div>
<div id="section-3" class="section level2">
<h2 class="hasAnchor">
<a href="#section-3" class="anchor"></a>1.6.0.0</h2>
<div id="section-4" class="section level3">
<h3 class="hasAnchor">
<a href="#section-4" class="anchor"></a>2018-05-08</h3>
<ul>
<li>Never-legislated Medicare levy change in 2019-20 has been reverted</li>
<li>Budget 2018:
<ul>
<li>
<code><a href="reference/model_income_tax.html">model_income_tax()</a></code> no longer coerces <code>WEIGHT</code> to integer.</li>
<li>New arguments to support Budget 2018:
<ul>
<li>
<code>lito_multi</code> Permits multiple pieces to the linear offset.</li>
<li>
<code>Budget2018_lamington</code> The Low And Middle Income Tax Offset proposed in the Budget 2018 budget.</li>
<li>
<code>Budget2018_lito_202223</code> The proposed change to LITO from 2022-23.</li>
<li>
<code>Budget2018_watr</code> The offset proposed by the Opposition the Budget Reply.</li>
<li>
<code>sbto_discount</code> Allows modification of the small business tax offset.</li>
<li>
<code>clear_tax_cols</code> By default, old tax columns are deleted.</li>
<li>
<code>warn_upper_thresholds</code> If changed to <code>FALSE</code> allows the automatic changes to be applied without warning.</li>
</ul>
</li>
</ul>
</li>
<li>New functions:
<ul>
<li>
<code><a href="reference/progressivity.html">progressivity()</a></code> for Gini-based measure of the progressivity of income tax</li>
<li>
<code><a href="reference/revenue_foregone.html">revenue_foregone()</a></code> as a convenenience for returning the revenue foregone from a modelled sample file.</li>
</ul>
</li>
<li>Routine changes:
<ul>
<li>ABS data updated as of 2018-05-21.</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="section-5" class="section level2">
<h2 class="hasAnchor">
<a href="#section-5" class="anchor"></a>1.5.3.6</h2>
<div id="section-6" class="section level3">
<h3 class="hasAnchor">
<a href="#section-6" class="anchor"></a>2018-02-21</h3>
<ul>
<li>Labour force data and wage price index updated to 2018-02-21.</li>
<li>Update as requested to fix failing unit tests relying on non-standard packages.</li>
</ul>
</div>
</div>
<div id="section-7" class="section level2">
<h2 class="hasAnchor">
<a href="#section-7" class="anchor"></a>1.5.3.1</h2>
<div id="section-8" class="section level3">
<h3 class="hasAnchor">
<a href="#section-8" class="anchor"></a>2018-01-22</h3>
</div>
<div id="new-features-1" class="section level3">
<h3 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>New features:</h3>
<ul>
<li>New function <code>model_income_tax</code> which attempts to provide every lever of the income tax system that is visible from the tax office’s sample files. Users can model the sample file by changing single parameters to observe the effect on tax collections.</li>
<li>
<code>small_business_tax_offset</code>: Include the small business tax offset as a standalone function and within <code>income_tax</code>.</li>
</ul>
</div>
<div id="other-user-visible-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#other-user-visible-changes" class="anchor"></a>Other user-visible changes</h3>
<ul>
<li>
<code>project</code> and <code>project_to</code> no longer require <code>fy.year.of.sample.file</code>. However, they expect the supplied <code>data.frame</code> to be compatible with the sample file provided. Failling to provide a sample file with the expected number of rows or not providing a sample file with a valid number of rows is a warning, which can be silenced by <code>check_fy_sample_file = FALSE</code>.</li>
</ul>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data:</h3>
<ul>
<li>Update labour force data to November 2017</li>
<li>Internal projection tables have been updated for the latest (2014-15) sample file.</li>
</ul>
</div>
<div id="other-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#other-changes" class="anchor"></a>Other changes</h3>
<ul>
<li>
<code>mgcv</code> was used but not declared in Suggests: Thanks to BDR for reporting.</li>
<li>(internal) Extend <code>prohibit_vector_recycling</code> to return the maximum permissible length of a list of vectors.</li>
</ul>
</div>
</div>
<div id="section-9" class="section level2">
<h2 class="hasAnchor">
<a href="#section-9" class="anchor"></a>1.5.2.5</h2>
<div id="section-10" class="section level3">
<h3 class="hasAnchor">
<a href="#section-10" class="anchor"></a>2017-11-16</h3>
<ul>
<li>Update wage data to 2017-Q3</li>
<li>Update labour force data to 2017-09</li>
<li>(internal) The <code>lf_trend</code> internal data table used to report the labour force in thousands of persons, as the ABS does. This seemed a bit strange, so now <code>obsValue</code> uses integers (i.e. just the labour force).</li>
<li>Vignettes now install <code>taxstats</code> to a temporary directory if not already installed, rather than the user or system’s library.</li>
</ul>
</div>
<div id="section-11" class="section level3">
<h3 class="hasAnchor">
<a href="#section-11" class="anchor"></a>2017-10-27</h3>
<ul>
<li>Update CPI data</li>
<li>Fix wage data</li>
</ul>
</div>
</div>
<div id="section-12" class="section level2">
<h2 class="hasAnchor">
<a href="#section-12" class="anchor"></a>1.5.2.3</h2>
<div id="section-13" class="section level3">
<h3 class="hasAnchor">
<a href="#section-13" class="anchor"></a>2017-10-21</h3>
<ul>
<li>Update labour-force data</li>
</ul>
</div>
</div>
<div id="section-14" class="section level2">
<h2 class="hasAnchor">
<a href="#section-14" class="anchor"></a>1.5.2.0</h2>
<div id="section-15" class="section level3">
<h3 class="hasAnchor">
<a href="#section-15" class="anchor"></a>2017-10-19</h3>
<ul>
<li>New internal C++ functions for <code>income_tax</code>, and related functions</li>
<li>BTO function now uses tax scales from the <em>Income Tax Regulations</em>
</li>
</ul>
</div>
</div>
<div id="section-16" class="section level2">
<h2 class="hasAnchor">
<a href="#section-16" class="anchor"></a>1.5.1.2</h2>
<div id="section-17" class="section level3">
<h3 class="hasAnchor">
<a href="#section-17" class="anchor"></a>2017-10-15</h3>
<ul>
<li>Optional argument <code>age</code> in <code>income_tax</code> now <code>NULL</code> rather than <code>42</code>.<br>
The default argument continues to result in SAPTO being not applied if <code>.dots.ATO</code>. However, if <code>.dots.ATO</code> is supplied (and the age variable has not been removed from it), the individuals’ SAPTO eligibility is determined by the age variable in <code>.dots.ATO</code>, rather than setting each individual’s SAPTO to 0.</li>
</ul>
</div>
<div id="section-18" class="section level3">
<h3 class="hasAnchor">
<a href="#section-18" class="anchor"></a>2017-08-30</h3>
<ul>
<li>Update labour force data. Avoid segfault in separate package in unit test.</li>
<li>Added a <code>NEWS.md</code> file to track changes to the package.</li>
</ul>
</div>
<div id="section-19" class="section level3">
<h3 class="hasAnchor">
<a href="#section-19" class="anchor"></a>2017-08-16</h3>
<ul>
<li>Update wage, CPI, labour force data</li>
</ul>
</div>
<div id="section-20" class="section level3">
<h3 class="hasAnchor">
<a href="#section-20" class="anchor"></a>2017-07-02</h3>
<ul>
<li>Update wage and labour force data</li>
<li>Fix breaking build due to change in dplyr API</li>
</ul>
</div>
</div>
</div>
<div id="cran-notes" class="section level1">
<h1 class="hasAnchor">
<a href="#cran-notes" class="anchor"></a>CRAN Notes</h1>
<p>This is a package resubmission after archival.</p>
<p>The vignettes have been protected from accessing taxstats packages; the packages will only be attempted to be installed if an environment variable is set.</p>
<div id="test-results" class="section level2">
<h2 class="hasAnchor">
<a href="#test-results" class="anchor"></a>Test results</h2>
<p>0 ERRORS | 0 WARNINGS | 1-2 NOTEs</p>
<div id="test-environments" class="section level3">
<h3 class="hasAnchor">
<a href="#test-environments" class="anchor"></a>Test environments:</h3>
<ul>
<li>Local Windows CRAN 3.6.0</li>
<li>Travis-CI: Ubuntu 14.04. R 3.5, 3.6, and dev (r76539)</li>
<li>Appveyor: dev (r76446) and release.</li>
<li>winbuilder: dev (r76539) and release.</li>
</ul>
<p>NOTES:</p>
<p>Package archival / previous violation of policy. ==&gt; Vignettes using package ‘taxstats’ is now off by default ==&gt; Installation of taxstats packages now requires manual setting of environment variable</p>
<p>Possibly mis-spelled words in DESCRIPTION: … ==&gt; Spellings are correct: ‘repos’ and ‘taxstats’ cannot be quoted as they are within R code.</p>
<p>URLs in angle brackets: ==&gt; Not appropriate since the URL is within R code.</p>
<p>Suggests or Enhances not in mainstream repositories: … ==&gt; Normal due to taxstats dependency</p>
</div>
</div>
<div id="note-to-cran-moderately-large-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#note-to-cran-moderately-large-vignette" class="anchor"></a>Note to CRAN: moderately-large vignette</h2>
<p>The vignette is quite lengthy and, if the environment variable is set, installs package ‘taxstats’, a 58 MB source package, each time the package is checked.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=grattan">https://​cloud.r-project.org/​package=grattan</a>
</li>
<li>Browse source code at <br><a href="https://github.com/HughParsonage/grattan">https://​github.com/​HughParsonage/​grattan</a>
</li>
<li>Report a bug at <br><a href="https://github.com/HughParsonage/grattan/issues">https://​github.com/​HughParsonage/​grattan/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Hugh Parsonage <br><small class="roles"> Author, maintainer </small>  </li>
<li>Tim Cameron <br><small class="roles"> Author </small>  </li>
<li>Brendan Coates <br><small class="roles"> Author </small>  </li>
<li>Matthew Katzen <br><small class="roles"> Author </small>  </li>
<li>William Young <br><small class="roles"> Author </small>  </li>
<li>Matt Cowgill <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/github/HughParsonage/grattan?branch=master"><img src="https://codecov.io/gh/HughParsonage/grattan/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://travis-ci.org/HughParsonage/grattan"><img src="https://travis-ci.org/HughParsonage/grattan.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hugh Parsonage, Tim Cameron, Brendan Coates, Matthew Katzen, William Young, Matt Cowgill.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
